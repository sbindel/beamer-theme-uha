% Name : beamerinnerthemeuha.sty
% Author : SÃ©bastien Bindel <sebastien.bindel@uha.fr>

%--------------------------------------------------------------
% Mandatory part
%--------------------------------------------------------------
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerinnerthemeuha}[2018/10/22 uha inner theme]


%--------------------------------------------------------------
% Paragraph spacing
%--------------------------------------------------------------
\setlength{\parskip}{1em}
\renewcommand{\baselinestretch}{1.1}
%
%--------------------------------------------------------------
% section format in the table of contents
%--------------------------------------------------------------
\setbeamertemplate{section in toc}[sections numbered]
\setbeamertemplate{subsection in toc}[subsections numbered]
%
% %--------------------------------------------------------------
% % Example block environment
% %--------------------------------------------------------------
\defbeamertemplate*{block example begin}{uha}{
	\par\vskip\medskipamount%
	\usebeamercolor{block title example}
	\begin{tikzpicture}
		\node [
			draw=fg,
			fill=bg,
			inner sep=2ex,
			text=fg,
			text width=\paperwidth - 2cm - 5ex,
			minimum width=\paperwidth - 2cm - 1ex,
			align=left,
			rounded corners=1pt,
			drop shadow={top color=black!50!white,
				bottom color=black!30!white,
				shadow xshift=3.5pt,
				shadow yshift=-3.5pt,
              rounded corners}
		] (BOXCONTENT) \bgroup \noindent%
		\usebeamerfont{beamer body}%
		\usebeamercolor{block body example}
	}

	\defbeamertemplate*{block example end}{uha}{
		\egroup;
		\usebeamercolor{block title example}
		\ifx\insertblocktitle\@empty
		\else%
			{
				\node [
					draw=fg,
					fill=fg,
					anchor=west,
					text=bg,
					rounded corners
				] at ([shift={(5pt,0)}]BOXCONTENT.north west) {\textbf{\insertblocktitle}};
			}
		\fi
	\end{tikzpicture}
	\vskip\smallskipamount
}

% %--------------------------------------------------------------
% % Alert block environment
% %-------------------------------------------------------------
\defbeamertemplate*{block alerted begin}{uha}
{
  \par\vskip\medskipamount%
  \usebeamercolor{block title alerted}
  \begin{tikzpicture}
    \node [
      draw=fg,
  	  fill=bg,
	  text=fg,
	  inner sep=2ex,
      text width=\paperwidth - 2cm - 5ex,
      minimum width=\paperwidth - 2cm - 1ex,
      align=left,
	  rounded corners=1pt,
	  drop shadow={top color=black!50!white,
				bottom color=black!30!white,
				shadow xshift=3.5pt,
				shadow yshift=-3.5pt,
			rounded corners}
    ] (BOXCONTENT) \bgroup \noindent%
    \usebeamerfont{beamer body}%
    \usebeamercolor{block body alerted}
}

\defbeamertemplate*{block alerted end}{uha}
{
  \egroup;
  \usebeamercolor{block title alerted}
  \ifx\insertblocktitle\@empty
  \else%
  {
    \node [
	  draw=fg,
      fill=fg,
      anchor=west,
      text=bg,
      rounded corners
  ] at ([shift={(5pt,0)}]BOXCONTENT.north west) {\textbf{\insertblocktitle}};
  }
  \fi
  \end{tikzpicture}
  \vskip\smallskipamount
}
% %--------------------------------------------------------------
% % Block environment
% %-------------------------------------------------------------
\defbeamertemplate*{block begin}{uha}
{
  \par\vskip\medskipamount%
  \usebeamercolor{block title}
  \ifx\insertblocktitle\@empty\newcommand{\yskiplength}{1.5ex}
  \else\newcommand{\yskiplength}{2ex}
  \fi
  \begin{tikzpicture}
    \node [
      draw=fg,
  	  fill=bg,
  	  text=fg,
      inner sep = 1ex,
      inner ysep = \yskiplength,
      text width=\paperwidth - 2cm - 5ex,
      minimum width=\paperwidth - 2cm - 1ex,
	  rounded corners=1pt,
	  drop shadow={top color=black!50!white,
	  bottom color=black!30!white,
		  shadow xshift=3.5pt,
		  shadow yshift=-3.5pt,
              rounded corners },
    ] (BOXCONTENT) \bgroup%
    \begin{minipage}{\textwidth}
    \usebeamerfont{beamer body}%
    \usebeamercolor{block body}%
}

\defbeamertemplate*{block end}{uha}
{
  \end{minipage}%
  \egroup;
  \usebeamercolor{block title}
  \ifx\insertblocktitle\@empty
  \else%
  {
    \node[
	  draw=fg,
      fill=fg,
      anchor=west,
      text=bg,
      rounded corners
  ] at ([shift={(5pt,0)}]BOXCONTENT.north west) {\textbf{\insertblocktitle}};
  }
  \fi
  \end{tikzpicture}
  \vskip\smallskipamount
}
%--------------------------------------------------------------
% Title frame
%--------------------------------------------------------------
\defbeamertemplate*{title page}{uha}{
  \nointerlineskip%
  \vskip0pt%
  \leavevmode
  \begin{beamercolorbox}[dp=0ex, wd=\paperwidth, ht=\paperheight, center]{titlepage}
              \resizebox{0.2\textwidth}{!}{\input{logo/logo-uha-title.tikz}}\strut\par
              \vskip20pt
              {\LARGE \bfseries \inserttitle}\strut\par
              \vskip10pt
              {\large \bfseries \insertsubtitle}\strut\par
              \vskip30pt
              {\bfseries\insertauthor}\strut\par
              \vskip1pt
              {\bfseries\insertinstitute}\strut\par
              \vskip20pt
              \insertdate\strut\par
              \vskip0.1\paperheight%
  \end{beamercolorbox}
}

\defbeamertemplate{title page}{uha/negative}{
  \nointerlineskip%
  \vskip0pt%
  \leavevmode
  \begin{beamercolorbox}[dp=0ex, wd=\paperwidth, ht=\paperheight, center]{titlepage negative}
              \resizebox{0.2\textwidth}{!}{\input{logo/logo-uha-title-negative.tikz}}\strut\par
              \vskip20pt
              {\LARGE \bfseries \inserttitle}\strut\par
              \vskip10pt
              {\large \bfseries \insertsubtitle}\strut\par
              \vskip30pt
              {\bfseries\insertauthor}\strut\par
              \vskip1pt
              {\bfseries\insertinstitute}\strut\par
              \vskip20pt
              \insertdate\strut\par
              \vskip0.1\paperheight%
  \end{beamercolorbox}
}

\AtBeginEnvironment{exampleblock}{\setbeamercolor{itemize item}{fg=uha@green}}
\AtBeginEnvironment{alertblock}{\setbeamercolor{itemize item}{fg=uha@red}}
