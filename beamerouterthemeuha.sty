% Name : beamerouterthemeuha.sty
% Author : Sébastien Bindel <sébastien.bindel@uha.fr>

%--------------------------------------------------------------
% Mandatory part
%--------------------------------------------------------------
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{beamerouterthemeuha}[2018/10/22 uha outer theme]

%--------------------------------------------------------------
% Remove navigation menu
%--------------------------------------------------------------
\setbeamertemplate{navigation symbols}{}

\makeatletter

%----------------------------------------------------
%   Header
%--------------------------------------------------------------
\defbeamertemplate*{frametitle}{uha}{
    \nointerlineskip
    \vskip-2pt%
    \begin{beamercolorbox}[sep=0ex, wd=\paperwidth, ht=6.3ex, dp=1ex, left, leftskip=4ex]{head/foot}%
        \usebeamerfont{frametitle}\insertframetitle
        \strut\par%
        \ifx\insertframesubtitle\@empty%
            \nointerlineskip
            \vphantom{\small Un sous titre}
        \else%
            \nointerlineskip
            \usebeamerfont{subframetitle}\hspace{1pt}\insertframesubtitle
        \fi
    \end{beamercolorbox}%
    \nointerlineskip%
     \vskip-4.5pt%
    \begin{beamercolorbox}[sep=0ex, wd=\paperwidth, ht=0.5ex, dp=0ex, leftskip=4ex]{headline}%
        \begin{tikzpicture}
            \draw[line width=0.5pt, rounded corners] (0,0) -- (0.85\linewidth,0);
        \end{tikzpicture}
    \end{beamercolorbox}%
}
%
\defbeamertemplate{frametitle}{uha/negative}{
    \nointerlineskip
    \vskip-2pt%
    \begin{beamercolorbox}[sep=0ex, wd=\paperwidth, ht=6.3ex, dp=1ex, left, leftskip=4ex]{head/foot negative}%
        \usebeamerfont{frametitle}\insertframetitle
        \strut\par%
        \ifx\insertframesubtitle\@empty%
            \nointerlineskip
            \vphantom{\small Un sous titre}
        \else%
            \nointerlineskip
            \usebeamerfont{subframetitle}\hspace{1pt}\insertframesubtitle
        \fi
    \end{beamercolorbox}%
    \nointerlineskip%
     \vskip-4.5pt%
    \begin{beamercolorbox}[sep=0ex, wd=\paperwidth, ht=0.5ex, dp=0ex, leftskip=4ex]{headline}%
        \begin{tikzpicture}
            \draw[line width=0.5pt, rounded corners] (0,0) -- (0.85\linewidth,0);
        \end{tikzpicture}
    \end{beamercolorbox}%
}
%--------------------------------------------------------------
% Footer
%--------------------------------------------------------------
\defbeamertemplate*{footline}{uha}{
    \ifnum \insertpagenumber=1
        \leavevmode%
        \hbox{%
            \begin{beamercolorbox}[wd=\paperwidth,ht=3ex,dp=1ex,center]{}%
                % empty environment to raise height
            \end{beamercolorbox}}%
            \vskip0pt%
    \else
        \nointerlineskip%
        \leavevmode%
        \begin{beamercolorbox}[sep=0ex, wd=0.3333\paperwidth, ht=2.5ex, dp=1ex, left, leftskip=2ex]{head/foot}%
            \resizebox{0.03\textwidth}{!}{\input{logo/logo-uha.tikz}} \insertinstitute
        \end{beamercolorbox}%
        \begin{beamercolorbox}[sep=0ex, wd=.3333\paperwidth, ht=2.5ex, dp=1ex, center]{head/foot}%
            %\usebeamerfont{footline}\insertshorttitle
        \end{beamercolorbox}%
        \begin{beamercolorbox}[sep=0ex, wd=.3333\paperwidth, ht=2.5ex, dp=1ex, right, rightskip=2ex]{head/foot}%
            \usebeamerfont{footline}\insertframenumber/\inserttotalframenumber
        \end{beamercolorbox}%
        \vskip0pt%
    \fi
}
% negative footer
\defbeamertemplate{footline}{uha/negative}{
    \ifnum \insertpagenumber=1
        \leavevmode%
        \hbox{%
            \begin{beamercolorbox}[wd=\paperwidth,ht=3ex,dp=1ex,center]{}%
                % empty environment to raise height
            \end{beamercolorbox}}%
            \vskip0pt%
    \else
        \nointerlineskip%
        \leavevmode%
        \begin{beamercolorbox}[sep=0ex, wd=0.3333\paperwidth, ht=2.5ex, dp=1ex, left, leftskip=2ex]{head/foot negative}%
            \resizebox{0.03\textwidth}{!}{\input{logo/logo-uha-negative.tikz}} \insertinstitute
        \end{beamercolorbox}%
        \begin{beamercolorbox}[sep=0ex, wd=.3333\paperwidth, ht=2.5ex, dp=1ex, center]{head/foot negative}%
            %\usebeamerfont{footline}\insertshorttitle
        \end{beamercolorbox}%
        \begin{beamercolorbox}[sep=0ex, wd=.3333\paperwidth, ht=2.5ex, dp=1ex, right, rightskip=2ex]{head/foot negative}%
            \usebeamerfont{footline}\insertframenumber/\inserttotalframenumber
        \end{beamercolorbox}%
        \vskip0pt%
    \fi
}
%--------------------------------------------------------------
% Section page
%--------------------------------------------------------------
\setbeamercolor{section page}{parent=palette secondary}
\defbeamertemplate*{section page}{uha}{
    \nointerlineskip%
    \vskip0pt%
    \leavevmode
    \begin{beamercolorbox}[wd=\paperwidth, ht=\paperheight, center]{sectionpage}
       \usebeamerfont{section}\insertsectionnumber.~\insertsection
       \vskip0.5\paperheight%
    \end{beamercolorbox}
}
\AtBeginSection{\frame[plain, noframenumbering]{\sectionpage}}
%
\makeatother
